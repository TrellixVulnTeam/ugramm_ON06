<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"/>
    <title>Î¼Grammar</title>
    <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>
    <!-- Yandex.Metrika counter -->
    <script type="text/javascript" >
       (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
       m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
       (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

       ym(88551642, "init", {
            clickmap:true,
            trackLinks:true,
            accurateTrackBounce:true
       });
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/88551642" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->
</head>
<body>

<div id="app"></div>
<script>
    'use strict';

    const e = React.createElement;

    class App extends React.Component {
        constructor(props) {
            super(props);
            this.state = {
                engine: "comma_distil_roberta",
                text: "We love contributions! There is a lot to do on Kotlin and on the standard library so why not chat with us about what you're interested in doing? Please join the #kontributors channel in our Slack chat and let us know about your plans.\n" +
                    "Currently only committers can assign issues to themselves so just add a comment if you're starting work on it.",
                version: "",
                matches: [],
                fixed: "",
                timings: ""
            };
        }

        callCheck(_this) {
            _this.setState({liked: true})
            fetch("/api/v1/check?engine=" + _this.state.engine, {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({"text": _this.state.text})
            })
                .then(res => {
                    _this.setState({timings: res.headers.get("Server-Timing")});
                    return res.json()
                })
                .then(
                    res => _this.setState({fixed: res["fixed"], version: res["version"], matches: res["matches"]}),
                    err => _this.setState({fixed: "#Error", version: "#Error", matches: "#Error"}),
                )
        }

        render() {
            let input = e(
                "textarea",
                {
                    cols: "80", rows: "5", value: this.state.text,
                    onChange: (event) => this.setState({text: event.target.value})
                }
            );
            let engine = e(
                "select", {value: this.state.engine, onChange: (event) => this.setState({engine: event.target.value})},
                e("option", {value: "dummy"}, "dummy"),
                e("option", {value: "languagetool"}, "languagetool"),
                e("option", {value: "nemo_punctuation_en_distilbert"}, "nemo_punctuation_en_distilbert"),
                e("option", {value: "nemo_punctuation_en_bert"}, "nemo_punctuation_en_bert"),
                e("option", {value: "comma_distil_roberta"}, "comma_distil_roberta"),
                e("option", {value: "comma_roberta"}, "comma_roberta"),
            );
            let btn = e(
                "button",
                {onClick: () => this.callCheck(this)},
                "Check"
            );
            let fixed = e("p", {}, "Fixed: " + this.state.fixed);
            let version = e("p", {}, "Version: " + this.state.version);
            let matches = e("p", {}, "Matches: " + JSON.stringify(this.state.matches));
            let timings = e("p", {}, "Timings: " + this.state.timings);
            return e(
                "div", {}, "Text to check:", e("br"), input, e("br"),
                "Engine:", engine, btn, fixed, version, matches, timings
            );
        }
    }

    const domContainer = document.querySelector("#app");
    ReactDOM.render(e(App), domContainer);
</script>

</body>
</html>